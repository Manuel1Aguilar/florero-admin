<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Manage Stock</title>
  <link rel="stylesheet" href="/styles.css">
  <script src="https://unpkg.com/htmx.org@1.6.1"></script>
</head>
<body>
  <% if (!authenticated) { %>
    <script>
      window.location.href = '/admin';
    </script>
  <% } %>
  <h1>Manage Stock</h1>

  <button id="add-color-button" hx-get="/admin/add-color-form" hx-target="#add-color-form" hx-swap="innerHTML">Add Color</button>
  <div id="add-color-form"></div>
  
  <table>
    <thead>
      <tr>
        <th>Color Name</th>
        <th>Color Key</th>
        <th>Hex Code</th>
        <th>Stock</th>
      </tr>
    </thead>
    <tbody>
      <% colors.forEach(color => { %>
        <tr id="color-<%= color.id %>">
          <td><%= color.cName %></td>
          <td><%= color.cKey %></td>
          <td><%= color.hex_code %></td>
          </td>
          <td>
              <form id="update-stock-form-<%= color.id %>" hx-post="/admin/update-stock" hx-target="#color-<%= color.id %>" hx-swap="outerHTML">
                <input type="hidden" name="color_id" value="<%= color.id %>">
                <input type="number" name="new_stock" min="0" value="<%= color.stock %>" required>
                <button type="submit">Update</button>
              </form>
          </td>
          <td>
              <button hx-post="/admin/delete-color" hx-target="#color-<%= color.id %>" hx-swap="outerHTML" hx-vals='{"color_id": "<%= color.id %>"}'>Delete</button>
          </td>
        </tr>
      <% }); %>
    </tbody>
  </table>

  <a href="/admin/manage-orders" hx-get="/admin/manage-orders" hx-target="body" hx-swap="innerHTML">Manage Orders</a>
</body>
</html>

